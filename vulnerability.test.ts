/**
 * Tests for vulnerability checking
 */

import { describe, expect, it } from 'vitest';

import { checkPlatform } from './vulnerability';

describe('checkPlatform', () => {
	it('should accept valid platforms', () => {
		expect(() => {
			checkPlatform('darwin');
		}).not.toThrow();
		expect(() => {
			checkPlatform('linux');
		}).not.toThrow();
		expect(() => {
			checkPlatform('win32');
		}).not.toThrow();
		expect(() => {
			checkPlatform(undefined);
		}).not.toThrow();
	});

	it('should reject invalid platforms', () => {
		expect(() => {
			checkPlatform('invalid');
		}).toThrow("Platform 'invalid' is not valid");
		expect(() => {
			checkPlatform('windows');
		}).toThrow("Platform 'windows' is not valid");
	});
});
